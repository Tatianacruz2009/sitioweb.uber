"use strict";(self.webpackChunkFusion=self.webpackChunkFusion||[]).push([[3351],{73351:(t,e,s)=>{s.d(e,{h:()=>xt});var i,r,n,a,o,h,u,l,c,d,p,f,v,b,w,g,y,m,R,O,k,E,C,P=s(90417),S=s(46786),M=s(41101),W=s(91604),x=s(43762),F=s(77227),U=s(29176),Q=s(19362),T=s(50415);function q(t,e){L(t,e),e.add(t)}function j(t,e,s){L(t,e),e.set(t,s)}function L(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function N(t,e,s){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return s}function I(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,K(t,e,"get"))}function D(t,e,s){return function(t,e,s){if(e.set)e.set.call(t,s);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=s}}(t,K(t,e,"set"),s),s}function K(t,e,s){if(!e.has(t))throw new TypeError("attempted to "+s+" private field on non-instance");return e.get(t)}var A=(i=new WeakMap,r=new WeakMap,n=new WeakMap,a=new WeakMap,o=new WeakMap,h=new WeakMap,u=new WeakMap,l=new WeakMap,c=new WeakMap,d=new WeakMap,p=new WeakMap,f=new WeakMap,v=new WeakMap,b=new WeakMap,w=new WeakSet,g=new WeakSet,y=new WeakSet,m=new WeakSet,R=new WeakSet,O=new WeakSet,k=new WeakSet,E=new WeakSet,C=new WeakSet,class extends Q.Q{constructor(t,e){super(),q(this,C),q(this,E),q(this,k),q(this,O),q(this,R),q(this,m),q(this,y),q(this,g),q(this,w),j(this,i,{writable:!0,value:void 0}),j(this,r,{writable:!0,value:void 0}),j(this,n,{writable:!0,value:void 0}),j(this,a,{writable:!0,value:void 0}),j(this,o,{writable:!0,value:void 0}),j(this,h,{writable:!0,value:void 0}),j(this,u,{writable:!0,value:void 0}),j(this,l,{writable:!0,value:void 0}),j(this,c,{writable:!0,value:void 0}),j(this,d,{writable:!0,value:void 0}),j(this,p,{writable:!0,value:void 0}),j(this,f,{writable:!0,value:void 0}),j(this,v,{writable:!0,value:void 0}),j(this,b,{writable:!0,value:new Set}),this.options=e,D(this,i,t),D(this,u,null),this.bindMethods(),this.setOptions(e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(I(this,r).addObserver(this),Y(I(this,r),this.options)?N(this,w,B).call(this):this.updateResult(),N(this,R,H).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Z(I(this,r),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Z(I(this,r),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,N(this,O,G).call(this),N(this,k,J).call(this),I(this,r).removeObserver(this)}setOptions(t,e){const s=this.options,n=I(this,r);if(this.options=I(this,i).defaultQueryOptions(t),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled)throw new Error("Expected enabled to be a boolean");N(this,E,V).call(this),I(this,r).setOptions(this.options),s._defaulted&&!(0,x.f8)(this.options,s)&&I(this,i).getQueryCache().notify({type:"observerOptionsUpdated",query:I(this,r),observer:this});const a=this.hasListeners();a&&tt(I(this,r),n,this.options,s)&&N(this,w,B).call(this),this.updateResult(e),!a||I(this,r)===n&&this.options.enabled===s.enabled&&this.options.staleTime===s.staleTime||N(this,g,z).call(this);const o=N(this,y,_).call(this);!a||I(this,r)===n&&this.options.enabled===s.enabled&&o===I(this,v)||N(this,m,$).call(this,o)}getOptimisticResult(t){const e=I(this,i).getQueryCache().build(I(this,i),t),s=this.createResult(e,t);return function(t,e){if(!(0,x.f8)(t.getCurrentResult(),e))return!0;return!1}(this,s)&&(D(this,a,s),D(this,h,this.options),D(this,o,I(this,r).state)),s}getCurrentResult(){return I(this,a)}trackResult(t,e){const s={};return Object.keys(t).forEach((i=>{Object.defineProperty(s,i,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(i),null==e||e(i),t[i])})})),s}trackProp(t){I(this,b).add(t)}getCurrentQuery(){return I(this,r)}refetch(){let{...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.fetch({...t})}fetchOptimistic(t){const e=I(this,i).defaultQueryOptions(t),s=I(this,i).getQueryCache().build(I(this,i),e);return s.isFetchingOptimistic=!0,s.fetch().then((()=>this.createResult(s,e)))}fetch(t){var e;return N(this,w,B).call(this,{...t,cancelRefetch:null===(e=t.cancelRefetch)||void 0===e||e}).then((()=>(this.updateResult(),I(this,a))))}createResult(t,e){const s=I(this,r),i=this.options,p=I(this,a),f=I(this,o),v=I(this,h),b=t!==s?t.state:I(this,n),{state:w}=t;let g,y={...w},m=!1;if(e._optimisticResults){const r=this.hasListeners(),n=!r&&Y(t,e),a=r&&tt(t,s,e,i);(n||a)&&(y={...y,...(0,T.k)(w.data,t.options)}),"isRestoring"===e._optimisticResults&&(y.fetchStatus="idle")}let{error:R,errorUpdatedAt:O,status:k}=y;if(e.select&&void 0!==y.data)if(p&&y.data===(null==f?void 0:f.data)&&e.select===I(this,l))g=I(this,c);else try{D(this,l,e.select),g=e.select(y.data),g=(0,x.pl)(null==p?void 0:p.data,g,e),D(this,c,g),D(this,u,null)}catch(t){D(this,u,t)}else g=y.data;if(void 0!==e.placeholderData&&void 0===g&&"pending"===k){let t;var E;if(null!=p&&p.isPlaceholderData&&e.placeholderData===(null==v?void 0:v.placeholderData))t=p.data;else if(t="function"==typeof e.placeholderData?e.placeholderData(null===(E=I(this,d))||void 0===E?void 0:E.state.data,I(this,d)):e.placeholderData,e.select&&void 0!==t)try{t=e.select(t),D(this,u,null)}catch(t){D(this,u,t)}void 0!==t&&(k="success",g=(0,x.pl)(null==p?void 0:p.data,t,e),m=!0)}I(this,u)&&(R=I(this,u),g=I(this,c),O=Date.now(),k="error");const C="fetching"===y.fetchStatus,P="pending"===k,S="error"===k,M=P&&C,W=void 0!==g;return{status:k,fetchStatus:y.fetchStatus,isPending:P,isSuccess:"success"===k,isError:S,isInitialLoading:M,isLoading:M,data:g,dataUpdatedAt:y.dataUpdatedAt,error:R,errorUpdatedAt:O,failureCount:y.fetchFailureCount,failureReason:y.fetchFailureReason,errorUpdateCount:y.errorUpdateCount,isFetched:y.dataUpdateCount>0||y.errorUpdateCount>0,isFetchedAfterMount:y.dataUpdateCount>b.dataUpdateCount||y.errorUpdateCount>b.errorUpdateCount,isFetching:C,isRefetching:C&&!P,isLoadingError:S&&!W,isPaused:"paused"===y.fetchStatus,isPlaceholderData:m,isRefetchError:S&&W,isStale:et(t,e),refetch:this.refetch}}updateResult(t){const e=I(this,a),s=this.createResult(I(this,r),this.options);if(D(this,o,I(this,r).state),D(this,h,this.options),void 0!==I(this,o).data&&D(this,d,I(this,r)),(0,x.f8)(s,e))return;D(this,a,s);const i={};!1!==(null==t?void 0:t.listeners)&&(()=>{if(!e)return!0;const{notifyOnChangeProps:t}=this.options,s="function"==typeof t?t():t;if("all"===s||!s&&!I(this,b).size)return!0;const i=new Set(null!=s?s:I(this,b));return this.options.throwOnError&&i.add("error"),Object.keys(I(this,a)).some((t=>{const s=t;return I(this,a)[s]!==e[s]&&i.has(s)}))})()&&(i.listeners=!0),N(this,C,X).call(this,{...i,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&N(this,R,H).call(this)}});function B(t){N(this,E,V).call(this);let e=I(this,r).fetch(this.options,t);return null!=t&&t.throwOnError||(e=e.catch(x.lQ)),e}function z(){if(N(this,O,G).call(this),x.S$||I(this,a).isStale||!(0,x.gn)(this.options.staleTime))return;const t=(0,x.j3)(I(this,a).dataUpdatedAt,this.options.staleTime);D(this,p,setTimeout((()=>{I(this,a).isStale||this.updateResult()}),t+1))}function _(){var t;return null!==(t="function"==typeof this.options.refetchInterval?this.options.refetchInterval(I(this,r)):this.options.refetchInterval)&&void 0!==t&&t}function $(t){N(this,k,J).call(this),D(this,v,t),!x.S$&&!1!==this.options.enabled&&(0,x.gn)(I(this,v))&&0!==I(this,v)&&D(this,f,setInterval((()=>{(this.options.refetchIntervalInBackground||U.m.isFocused())&&N(this,w,B).call(this)}),I(this,v)))}function H(){N(this,g,z).call(this),N(this,m,$).call(this,N(this,y,_).call(this))}function G(){I(this,p)&&(clearTimeout(I(this,p)),D(this,p,void 0))}function J(){I(this,f)&&(clearInterval(I(this,f)),D(this,f,void 0))}function V(){const t=I(this,i).getQueryCache().build(I(this,i),this.options);if(t===I(this,r))return;const e=I(this,r);D(this,r,t),D(this,n,t.state),this.hasListeners()&&(null==e||e.removeObserver(this),t.addObserver(this))}function X(t){F.j.batch((()=>{t.listeners&&this.listeners.forEach((t=>{t(I(this,a))})),I(this,i).getQueryCache().notify({query:I(this,r),type:"observerResultsUpdated"})}))}function Y(t,e){return function(t,e){return!1!==e.enabled&&void 0===t.state.data&&!("error"===t.state.status&&!1===e.retryOnMount)}(t,e)||void 0!==t.state.data&&Z(t,e,e.refetchOnMount)}function Z(t,e,s){if(!1!==e.enabled){const i="function"==typeof s?s(t):s;return"always"===i||!1!==i&&et(t,e)}return!1}function tt(t,e,s,i){return(t!==e||!1===i.enabled)&&(!s.suspense||"error"!==t.state.status)&&et(t,s)}function et(t,e){return!1!==e.enabled&&t.isStaleByTime(e.staleTime)}function st(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var it=P.createContext(st()),rt=P.createContext(!1);rt.Provider;function nt(t,e){return"function"==typeof t?t(...e):!!t}function at(){}function ot(t,e,s){const i=(0,W.jE)(s),r=P.useContext(rt),n=P.useContext(it),a=i.defaultQueryOptions(t);a._optimisticResults=r?"isRestoring":"optimistic",(t=>{t.suspense&&"number"!=typeof t.staleTime&&(t.staleTime=1e3)})(a),((t,e)=>{(t.suspense||t.throwOnError)&&(e.isReset()||(t.retryOnMount=!1))})(a,n),(t=>{P.useEffect((()=>{t.clearReset()}),[t])})(n);const[o]=P.useState((()=>new e(i,a))),h=o.getOptimisticResult(a);if(P.useSyncExternalStore(P.useCallback((t=>{const e=r?()=>{}:o.subscribe(F.j.batchCalls(t));return o.updateResult(),e}),[o,r]),(()=>o.getCurrentResult()),(()=>o.getCurrentResult())),P.useEffect((()=>{o.setOptions(a,{listeners:!1})}),[a,o]),((t,e)=>(null==t?void 0:t.suspense)&&e.isPending)(a,h))throw((t,e,s)=>e.fetchOptimistic(t).catch((()=>{s.clearReset()})))(a,o,n);if((t=>{let{result:e,errorResetBoundary:s,throwOnError:i,query:r}=t;return e.isError&&!s.isReset()&&!e.isFetching&&r&&nt(i,[e.error,r])})({result:h,errorResetBoundary:n,throwOnError:a.throwOnError,query:i.getQueryCache().get(a.queryHash)}))throw h.error;return a.notifyOnChangeProps?h:o.trackResult(h)}var ht=s(31253),ut=class extends A{constructor(t,e){super(t,e)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(t,e){super.setOptions({...t,behavior:(0,ht.PL)()},e)}getOptimisticResult(t){return t.behavior=(0,ht.PL)(),super.getOptimisticResult(t)}fetchNextPage(t){return this.fetch({...t,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(t){return this.fetch({...t,meta:{fetchMore:{direction:"backward"}}})}createResult(t,e){var s;const{state:i}=t,r=super.createResult(t,e),{isFetching:n,isRefetching:a,isError:o,isRefetchError:h}=r,u=null===(s=i.fetchMeta)||void 0===s||null===(s=s.fetchMore)||void 0===s?void 0:s.direction,l=o&&"forward"===u,c=n&&"forward"===u,d=o&&"backward"===u,p=n&&"backward"===u;return{...r,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:(0,ht.rB)(e,i.data),hasPreviousPage:(0,ht.RQ)(e,i.data),isFetchNextPageError:l,isFetchingNextPage:c,isFetchPreviousPageError:d,isFetchingPreviousPage:p,isRefetchError:h&&!l&&!d,isRefetching:a&&!c&&!p}}};var lt,ct,dt,pt,ft,vt,bt=s(6952);function wt(t,e){yt(t,e),e.add(t)}function gt(t,e,s){yt(t,e),e.set(t,s)}function yt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mt(t,e){return function(t,e){if(e.get)return e.get.call(t);return e.value}(t,kt(t,e,"get"))}function Rt(t,e,s){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return s}function Ot(t,e,s){return function(t,e,s){if(e.set)e.set.call(t,s);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=s}}(t,kt(t,e,"set"),s),s}function kt(t,e,s){if(!e.has(t))throw new TypeError("attempted to "+s+" private field on non-instance");return e.get(t)}var Et=(lt=new WeakMap,ct=new WeakMap,dt=new WeakMap,pt=new WeakMap,ft=new WeakSet,vt=new WeakSet,class extends Q.Q{constructor(t,e){super(),wt(this,vt),wt(this,ft),gt(this,lt,{writable:!0,value:void 0}),gt(this,ct,{writable:!0,value:void 0}),gt(this,dt,{writable:!0,value:void 0}),gt(this,pt,{writable:!0,value:void 0}),Ot(this,lt,t),this.setOptions(e),this.bindMethods(),Rt(this,ft,Ct).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var e;const s=this.options;this.options=mt(this,lt).defaultMutationOptions(t),(0,x.f8)(this.options,s)||mt(this,lt).getMutationCache().notify({type:"observerOptionsUpdated",mutation:mt(this,dt),observer:this}),null!=s&&s.mutationKey&&this.options.mutationKey&&(0,x.EN)(s.mutationKey)!==(0,x.EN)(this.options.mutationKey)?this.reset():"pending"===(null===(e=mt(this,dt))||void 0===e?void 0:e.state.status)&&mt(this,dt).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(null===(t=mt(this,dt))||void 0===t||t.removeObserver(this))}onMutationUpdate(t){Rt(this,ft,Ct).call(this),Rt(this,vt,Pt).call(this,t)}getCurrentResult(){return mt(this,ct)}reset(){var t;null===(t=mt(this,dt))||void 0===t||t.removeObserver(this),Ot(this,dt,void 0),Rt(this,ft,Ct).call(this),Rt(this,vt,Pt).call(this)}mutate(t,e){var s;return Ot(this,pt,e),null===(s=mt(this,dt))||void 0===s||s.removeObserver(this),Ot(this,dt,mt(this,lt).getMutationCache().build(mt(this,lt),this.options)),mt(this,dt).addObserver(this),mt(this,dt).execute(t)}});function Ct(){var t,e;const s=null!==(t=null===(e=mt(this,dt))||void 0===e?void 0:e.state)&&void 0!==t?t:(0,bt.$)();Ot(this,ct,{...s,isPending:"pending"===s.status,isSuccess:"success"===s.status,isError:"error"===s.status,isIdle:"idle"===s.status,mutate:this.mutate,reset:this.reset})}function Pt(t){F.j.batch((()=>{if(mt(this,pt)&&this.hasListeners()){const u=mt(this,ct).variables,l=mt(this,ct).context;var e,s,i,r;if("success"===(null==t?void 0:t.type))null===(e=(s=mt(this,pt)).onSuccess)||void 0===e||e.call(s,t.data,u,l),null===(i=(r=mt(this,pt)).onSettled)||void 0===i||i.call(r,t.data,null,u,l);else if("error"===(null==t?void 0:t.type)){var n,a,o,h;null===(n=(a=mt(this,pt)).onError)||void 0===n||n.call(a,t.error,u,l),null===(o=(h=mt(this,pt)).onSettled)||void 0===o||o.call(h,void 0,t.error,u,l)}}this.listeners.forEach((t=>{t(mt(this,ct))}))}))}s(40014);const St={registerEffect:()=>!0},Mt=(0,P.createContext)(St),Wt=Symbol("rpc-skip-token"),xt=()=>{const t=(0,S.b5)(),e=()=>{const e=(0,P.useContext)(M.E1);return(0,M.Am)(t).from(e)},s=(t,e)=>(0,P.useMemo)((()=>[t,e]),[t,e]);return{useRpcQueryKey:s,useRpcQuery:(t,i,r)=>{const n=e(),a=s(t,i),o=(0,W.jE)(),{registerEffect:h}=(0,P.useContext)(Mt),u={queryKey:a,queryFn:i===Wt?x.hT:e=>{let{signal:s}=e;return n.request(t,i,void 0,{signal:s})},...r},{queryKeyHashFn:l=x.EN}=u;return!1!==u.enabled&&h((()=>[t.toString(),l(u.queryKey)]),(()=>o.prefetchQuery(u))),function(t,e){return ot(t,A,e)}(u)},useRpcInfiniteQuery:(t,i,r)=>{const n=e();return function(t,e){return ot(t,ut,e)}({queryKey:s(t,i()),initialPageParam:void 0,queryFn:e=>n.request(t,i(e.pageParam),void 0,{signal:e.signal}),...r})},useRpcMutation:(t,s)=>{const i=e();return function(t,e){const s=(0,W.jE)(e),[i]=P.useState((()=>new Et(s,t)));P.useEffect((()=>{i.setOptions(t)}),[i,t]);const r=P.useSyncExternalStore(P.useCallback((t=>i.subscribe(F.j.batchCalls(t))),[i]),(()=>i.getCurrentResult()),(()=>i.getCurrentResult())),n=P.useCallback(((t,e)=>{i.mutate(t,e).catch(at)}),[i]);if(r.error&&nt(i.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:n,mutateAsync:r.mutate}}({mutationFn:e=>i.request(t,e),...s})}}}}}]);
//# sourceMappingURL=https://sourcemaps.uberinternal.com/raw/uber-sites/client-3351-4c7c640db54013be.js.map